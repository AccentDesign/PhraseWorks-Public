import{j as e,r as l,A as J}from"./index-tXWzwyu_.js";import{V as K,H as Q,P as W,F as X}from"./PageContent-CJIyYefX.js";import{A as Y,a as ee,b as se,c as ae}from"./APIMedia-Cg6lNLxD.js";import{z as j,L as p,F as B}from"./XMarkIcon-Uvv-OvJ9.js";import"./index-De3JtuBA.js";const te=({setSliderOpen:t})=>e.jsx("div",{className:"relative overflow-hidden bg-white shadow-md dark:bg-gray-800 sm:rounded-lg",children:e.jsxs("div",{className:"flex-row items-center justify-between p-4 space-y-3 sm:flex sm:space-y-0 sm:space-x-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl",children:"Media Library"})}),e.jsxs("button",{type:"button",className:"flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",onClick:()=>{t(!0)},children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-2 -ml-1",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"})}),"Add New Media File"]})]})}),re=({view:t,setView:r,search:s,setSearch:a,type:o,setType:x})=>e.jsx("div",{className:"relative bg-white shadow-md dark:bg-gray-800 sm:rounded-lg mt-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-between p-4 space-y-3 md:flex-row md:space-y-0 md:space-x-4",children:[e.jsx("div",{className:"w-full md:w-1/2",children:e.jsxs("form",{className:"flex items-center",children:[e.jsxs("div",{className:"mr-2 flex flex-row items-center",children:[e.jsx("button",{type:"button",className:`px-3 py-2 font-medium rounded shadow ${t=="squares"?"text-gray-800 bg-gray-200 hover:bg-gray-300":"bg-gray-50 text-gray-200"}`,onClick:()=>r("squares"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:e.jsx("path",{fillRule:"evenodd",d:"M3 6a3 3 0 0 1 3-3h2.25a3 3 0 0 1 3 3v2.25a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6Zm9.75 0a3 3 0 0 1 3-3H18a3 3 0 0 1 3 3v2.25a3 3 0 0 1-3 3h-2.25a3 3 0 0 1-3-3V6ZM3 15.75a3 3 0 0 1 3-3h2.25a3 3 0 0 1 3 3V18a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-2.25Zm9.75 0a3 3 0 0 1 3-3H18a3 3 0 0 1 3 3V18a3 3 0 0 1-3 3h-2.25a3 3 0 0 1-3-3v-2.25Z",clipRule:"evenodd"})})}),e.jsx("button",{type:"button",className:`ml-2 px-3 py-2 font-medium rounded shadow ${t=="list"?"text-gray-800 bg-gray-200 hover:bg-gray-300":"bg-gray-50 text-gray-200"}`,onClick:()=>r("list"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:e.jsx("path",{fillRule:"evenodd",d:"M2.625 6.75a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0A.75.75 0 0 1 8.25 6h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75ZM2.625 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0ZM7.5 12a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12A.75.75 0 0 1 7.5 12Zm-4.875 5.25a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"})})})]}),e.jsx("label",{htmlFor:"simple-search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{"aria-hidden":"true",className:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx("input",{type:"text",id:"simple-search",className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Search",required:"",value:s,onChange:i=>a(i.target.value)})]})]})}),e.jsx("div",{className:"flex flex-col items-stretch justify-end flex-shrink-0 w-full space-y-2 md:w-auto md:flex-row md:space-y-0 md:items-center md:space-x-3",children:e.jsx("div",{className:"flex items-center w-full space-x-3 md:w-auto",children:e.jsxs("select",{id:"filter",className:"bg-gray-100 border-gray-300 border px-4 py-2 divide-y divide-gray-100 rounded shadow w-44 dark:bg-gray-700 dark:divide-gray-600",value:o,onChange:i=>x(i.target.value),children:[e.jsx("option",{value:"all",children:"All Media Items"}),e.jsx("option",{value:"image",children:"Images"}),e.jsx("option",{value:"document",children:"Documents"})]})})})]})}),le=({bulkAction:t,setBulkAction:r,handleApply:s})=>e.jsxs("div",{className:"flex flex-row items-center mt-4",children:[e.jsxs("select",{id:"actionsDropdown",className:"bg-gray-100 border-gray-300 border px-4 py-2 divide-y divide-gray-100 rounded shadow w-44 dark:bg-gray-700 dark:divide-gray-600",value:t,onChange:a=>r(a.target.value),children:[e.jsx("option",{value:"",children:"Bulk Actions"}),e.jsx("option",{value:"delete",children:"Delete Permenantly"})]}),e.jsxs("button",{type:"button",className:"ml-4 flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",onClick:s,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-2 -ml-1",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"})}),"Apply"]})]}),ne=({files:t,selectedIds:r,toggleCheckbox:s})=>e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-200  ",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"File"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Author"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Uploaded to"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Date"})]})}),e.jsx("tbody",{children:t.map((a,o)=>e.jsxs("tr",{className:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700 border-gray-200",children:[e.jsx("th",{scope:"row",className:"px-6 py-4 w-[40px] font-medium text-gray-900 whitespace-nowrap dark:text-white",children:e.jsx("input",{id:"default-checkbox",type:"checkbox",value:a.id,checked:r.includes(a.id),onChange:()=>s(a.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 focus:ring-2"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("img",{src:a.url,className:"w-[150px]"}),e.jsx("span",{className:"ml-4",children:a.filename})]})}),e.jsx("td",{className:"px-6 py-4",children:a.author.user_login}),e.jsx("td",{className:"px-6 py-4",children:"-"}),e.jsx("td",{className:"px-6 py-4",children:new Date(a.date).toLocaleDateString()})]},o))})]}),ie=({files:t,ShowDetails:r})=>e.jsx("div",{className:"flex flex-wrap gap-4",children:t.map((s,a)=>{var x,i,h;const o=((h=(i=(x=s==null?void 0:s.attachment_metadata)==null?void 0:x.sizes)==null?void 0:i.find(n=>n.slug==="thumbnail"))==null?void 0:h.file)||(s==null?void 0:s.filename);return e.jsxs("button",{type:"button",className:"w-[150px] flex flex-col items-center gap-2 cursor-pointer",onClick:()=>r(s.id),children:[e.jsx("img",{src:`http://localhost:8787/r2/${o}`,className:"w-[150px] h-[150px] object-cover",alt:(s==null?void 0:s.post_title)||(s==null?void 0:s.filename)}),e.jsx("span",{className:"w-full text-center break-words whitespace-normal text-sm overflow-hidden line-clamp-2",children:s.filename})]},a)})}),de=({totalFiles:t,page:r,perPage:s,setPage:a})=>{const o=async()=>{a(1)},x=async()=>{a(r-1)},i=async()=>{a(r+1)},h=async()=>{a(Math.ceil(t/s))};return e.jsxs("div",{className:"flex flex-rows justify-end items-center px-4 py-8",children:[e.jsxs("p",{className:"mr-4",children:[t," items"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${r==1?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:o,children:"«"}),e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${r==1?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:x,children:"‹"}),e.jsxs("p",{children:[r," of ",Math.ceil(t/s)]}),e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${r==Math.ceil(t/s)?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:i,children:"›"}),e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${r==Math.ceil(t/s)?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:h,children:"»"})]})]})},oe=({sliderOpen:t,setSliderOpen:r,HandleClose:s,imgUrl:a,handleChange:o,SendData:x,fileInputRef:i})=>{const[h,n]=l.useState(!1),y=d=>{if(d.preventDefault(),d.stopPropagation(),n(!1),d.dataTransfer.files&&d.dataTransfer.files.length>0){const f=d.dataTransfer.files;i.current.files=f,o({target:{files:f}})}},g=d=>{d.preventDefault(),d.stopPropagation(),n(!0)},v=d=>{d.preventDefault(),d.stopPropagation(),n(!1)};return e.jsx(j.Root,{show:t,as:l.Fragment,children:e.jsxs(p,{as:"div",className:"relative z-30",onClose:s,children:[e.jsx("div",{className:"fixed inset-0"}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10 sm:pl-16",children:e.jsx(j.Child,{as:l.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(p.Panel,{className:"pointer-events-auto w-screen max-w-7xl",children:e.jsx("div",{className:"bg-white flex h-full flex-col overflow-y-scroll  py-6 shadow-2xl",children:e.jsx("div",{className:"px-4 sm:px-6",children:e.jsx("div",{className:"relative mt-6 flex-1 px-4 sm:px-6",children:e.jsx("div",{className:"flex items-start justify-start",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-start justify-between w-full pt-3",children:[e.jsx(p.Title,{className:"text-gray-900 text-base font-semibold leading-6",children:"Add File"}),e.jsx("div",{className:"ml-3 flex h-7 items-center",children:e.jsxs("button",{type:"button",className:"bg-white relative rounded-md text-gray-400 hover:text-gray-500",onClick:()=>{r(!1)},children:[e.jsx("span",{className:"absolute -inset-2.5"}),e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(B,{className:"h-6 w-6","aria-hidden":"true"})]})})]}),e.jsxs("div",{className:`flex flex-row items-center p-4 mt-8 border-4 border-dashed rounded-md min-h-40 ${h?"border-blue-500 bg-blue-50":"border-gray-300"}`,onDrop:y,onDragOver:g,onDragLeave:v,children:[e.jsx("input",{type:"file",multiple:!0,ref:i,onChange:o}),e.jsx("button",{className:"ml-4 flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",type:"submit",onClick:async()=>{await x()},children:"Upload"})]}),a&&e.jsx("img",{src:a,className:"w-[150px]",alt:"Uploaded Preview"})]})})})})})})})})})})]})})},ce=({sliderDetailsOpen:t,setSliderDetailsOpen:r,HandleClose:s,files:a,detailsId:o,toggleCheckbox:x,setBulkAction:i,setApplyTriggered:h})=>e.jsx(j.Root,{show:t,as:l.Fragment,children:e.jsxs(p,{as:"div",className:"relative z-30",onClose:s,children:[e.jsx("div",{className:"fixed inset-0"}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10 sm:pl-16",children:e.jsx(j.Child,{as:l.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(p.Panel,{className:"pointer-events-auto w-screen max-w-7xl",children:e.jsx("div",{className:"bg-white flex h-full flex-col overflow-y-scroll  py-6 shadow-2xl",children:e.jsx("div",{className:"px-4 sm:px-6",children:e.jsx("div",{className:"relative mt-6 flex-1 px-4 sm:px-6",children:e.jsx("div",{className:"flex items-start justify-start",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-start justify-between w-full pt-3",children:[e.jsx(p.Title,{className:"text-gray-900 text-base font-semibold leading-6",children:"File Details"}),e.jsx("div",{className:"ml-3 flex h-7 items-center",children:e.jsxs("button",{type:"button",className:"bg-white relative rounded-md text-gray-400 hover:text-gray-500",onClick:()=>{r(!1)},children:[e.jsx("span",{className:"absolute -inset-2.5"}),e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx(B,{className:"h-6 w-6","aria-hidden":"true"})]})})]}),e.jsx("div",{className:"mt-4",children:a.filter(n=>n.id==o).map(n=>e.jsxs("div",{className:"flex flex-row",children:[e.jsx("div",{className:"w-1/2",children:e.jsx("img",{src:n.url,className:"w-full"})}),e.jsxs("div",{className:"w-1/2 pl-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Filename:"})," ",n.filename]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Uploaded By:"})," ",n.author.user_login]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Uploaded On:"})," ",new Date(n.date).toLocaleDateString()]}),e.jsx("hr",{className:"my-4"}),"Inputs...",e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 text-sm",children:"View media file"}),e.jsx("a",{href:n.url,download:n.filename||"file",className:"text-blue-500 text-sm",target:"_blank",rel:"noopener noreferrer",children:"Download file"}),e.jsx("button",{type:"button",className:"text-red-500 text-sm cursor-pointer",onClick:()=>{x(n.id),i("delete"),h(!0)},children:"Delete permanently"})]})]})]},n.id))})]})})})})})})})})})})]})}),xe=()=>{const{loginPassword:t}=l.useContext(J);document.title="Media";const r=l.useRef(),[s,a]=l.useState(null),[o,x]=l.useState(null),[i,h]=l.useState([]),[n,y]=l.useState(1),[g,v]=l.useState([]),[d,f]=l.useState(""),[L,Z]=l.useState(0),[U,V]=l.useState(null),[w,z]=l.useState("squares"),[b,O]=l.useState("all"),[N,$]=l.useState(""),F=20,[H,A]=l.useState(!1),[_,k]=l.useState(!1),[M,P]=l.useState(!1),T=()=>{},R=c=>{v(u=>u.includes(c)?u.filter(m=>m!==c):[...u,c])},I=async()=>{d==="delete"&&g.length>0&&(await Y(t,g),C(),k(!1))},q=c=>{a(c.target.files[0])},E=c=>{V(c),k(!0)},G=async()=>{const c=r.current.files;if(c.length)try{if((await se(t,Array.from(c))).status==200){const m=s.name,D=await ae(m),S=URL.createObjectURL(D);x(S),y(1),C()}}catch(u){console.error("Upload or fetch failed:",u)}},C=async()=>{const c=await ee(t,(n-1)*F,b,N);if(c.status==200){const u=[];Z(c.data.getMediaFiles.total),c.data.getMediaFiles.files.map(m=>{const D=`http://localhost:8787/r2/${m.filename}`,S={id:m.id,filename:m.filename,mimetype:m.mimetype,url:D,author:m.author,date:m.date,attachment_metadata:JSON.parse(m.attachment_metadata)};u.push(S)}),h(u)}};return l.useEffect(()=>{M&&d==="delete"&&(I(),P(!1))},[d,M]),l.useEffect(()=>{C()},[n,b,N]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full",children:[e.jsx(te,{setSliderOpen:A}),e.jsx(re,{view:w,setView:z,search:N,setSearch:$,type:b,setType:O}),w=="list"&&e.jsx(le,{bulkAction:d,setBulkAction:f,handleApply:I}),e.jsxs("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg w-full mt-8",children:[w=="list"?e.jsx(ne,{files:i,selectedIds:g,toggleCheckbox:R}):e.jsx(ie,{files:i,ShowDetails:E}),e.jsx(de,{totalFiles:L,page:n,perPage:F,setPage:y})]})]}),e.jsx(oe,{sliderOpen:H,setSliderOpen:A,HandleClose:T,imgUrl:o,handleChange:q,SendData:G,fileInputRef:r}),e.jsx(ce,{sliderDetailsOpen:_,setSliderDetailsOpen:k,HandleClose:T,files:i,detailsId:U,toggleCheckbox:R,setBulkAction:f,setApplyTriggered:P})]})},fe=()=>e.jsxs(K,{children:[e.jsx(Q,{}),e.jsx(W,{children:e.jsx(xe,{})}),e.jsx(X,{})]});export{fe as default};
