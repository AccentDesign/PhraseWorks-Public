import{a0 as n}from"./vendor-other.js";import{r as e}from"./vendor-react.js";var t=function(){return t=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},t.apply(this,arguments)},o={onActivate:n.func,onAddUndo:n.func,onBeforeAddUndo:n.func,onBeforeExecCommand:n.func,onBeforeGetContent:n.func,onBeforeRenderUI:n.func,onBeforeSetContent:n.func,onBeforePaste:n.func,onBlur:n.func,onChange:n.func,onClearUndos:n.func,onClick:n.func,onContextMenu:n.func,onCommentChange:n.func,onCompositionEnd:n.func,onCompositionStart:n.func,onCompositionUpdate:n.func,onCopy:n.func,onCut:n.func,onDblclick:n.func,onDeactivate:n.func,onDirty:n.func,onDrag:n.func,onDragDrop:n.func,onDragEnd:n.func,onDragGesture:n.func,onDragOver:n.func,onDrop:n.func,onExecCommand:n.func,onFocus:n.func,onFocusIn:n.func,onFocusOut:n.func,onGetContent:n.func,onHide:n.func,onInit:n.func,onInput:n.func,onKeyDown:n.func,onKeyPress:n.func,onKeyUp:n.func,onLoadContent:n.func,onMouseDown:n.func,onMouseEnter:n.func,onMouseLeave:n.func,onMouseMove:n.func,onMouseOut:n.func,onMouseOver:n.func,onMouseUp:n.func,onNodeChange:n.func,onObjectResizeStart:n.func,onObjectResized:n.func,onObjectSelected:n.func,onPaste:n.func,onPostProcess:n.func,onPostRender:n.func,onPreProcess:n.func,onProgressState:n.func,onRedo:n.func,onRemove:n.func,onReset:n.func,onSaveContent:n.func,onSelectionChange:n.func,onSetAttrib:n.func,onSetContent:n.func,onShow:n.func,onSubmit:n.func,onUndo:n.func,onVisualAid:n.func,onSkinLoadError:n.func,onThemeLoadError:n.func,onModelLoadError:n.func,onPluginLoadError:n.func,onIconsLoadError:n.func,onLanguageLoadError:n.func,onScriptsLoad:n.func,onScriptsLoadError:n.func},r=t({apiKey:n.string,licenseKey:n.string,id:n.string,inline:n.bool,init:n.object,initialValue:n.string,onEditorChange:n.func,value:n.string,tagName:n.string,tabIndex:n.number,cloudChannel:n.string,plugins:n.oneOfType([n.string,n.array]),toolbar:n.oneOfType([n.string,n.array]),disabled:n.bool,readonly:n.bool,textareaName:n.string,tinymceScriptSrc:n.oneOfType([n.string,n.arrayOf(n.string),n.arrayOf(n.shape({src:n.string,async:n.bool,defer:n.bool}))]),rollback:n.oneOfType([n.number,n.oneOf([!1])]),scriptLoading:n.shape({async:n.bool,defer:n.bool,delay:n.number})},o),i=function(n){var e=n;return e&&e.tinymce?e.tinymce:null};const a=n=>parseInt(n,10),s=(n,e)=>{const t=n-e;return 0===t?0:t>0?1:-1},c=(n,e,t)=>({major:n,minor:e,patch:t}),u=n=>{const e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?c(a(e[1]),a(e[2]),a(e[3])):c(0,0,0)},l=(n,e)=>!!n&&-1===((n,e)=>{const t=s(n.major,e.major);if(0!==t)return t;const o=s(n.minor,e.minor);if(0!==o)return o;const r=s(n.patch,e.patch);return 0!==r?r:0})((n=>u((n=>[n.majorVersion,n.minorVersion].join(".").split(".").slice(0,3).join("."))(n)))(n),u(e));var p,d,f=function(n){return"function"==typeof n},h=function(n){return n in o},v=function(n){return n.substr(2)},y=function(n,e,t,o,r){return function(n,e,t,o,r,i,a){var s=Object.keys(r).filter(h),c=Object.keys(i).filter(h),u=s.filter(function(n){return void 0===i[n]}),l=c.filter(function(n){return void 0===r[n]});u.forEach(function(n){var e=v(n),o=a[e];t(e,o),delete a[e]}),l.forEach(function(t){var r=o(n,t),i=v(t);a[i]=r,e(i,r)})}(r,n.on.bind(n),n.off.bind(n),function(e,t){return function(o){var r;return null===(r=e(t))||void 0===r?void 0:r(o,n)}},e,t,o)},g=0,m=function(n){var e=Date.now();return n+"_"+Math.floor(1e9*Math.random())+ ++g+String(e)},b=function(n){return null!==n&&("textarea"===n.tagName.toLowerCase()||"input"===n.tagName.toLowerCase())},C=function(n){return void 0===n||""===n?[]:Array.isArray(n)?n:n.split(" ")},E=function(n,e){void 0!==n&&(null!=n.mode&&"object"==typeof n.mode&&"function"==typeof n.mode.set?n.mode.set(e):n.setMode(e))},S=function(n){var e=i(n);if(!e)throw new Error("tinymce should have been loaded into global scope");return e},k=function(n){var e=S(n);return!l(e,"7.6.0")},w=function(){return w=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},w.apply(this,arguments)},I=function(n,e,t){var o,r,i=n.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=e.id,i.src=e.src,i.async=null!==(o=e.async)&&void 0!==o&&o,i.defer=null!==(r=e.defer)&&void 0!==r&&r;var a=function(){i.removeEventListener("load",a),i.removeEventListener("error",s),t(e.src)},s=function(n){i.removeEventListener("load",a),i.removeEventListener("error",s),t(e.src,n)};i.addEventListener("load",a),i.addEventListener("error",s),n.head&&n.head.appendChild(i)},O=(p=[],d=function(n){var e=p.find(function(e){return e.getDocument()===n});return void 0===e&&(e=function(n){var e={},t=function(n,t){var o=e[n];o.done=!0,o.error=t;for(var r=0,i=o.handlers;r<i.length;r++)(0,i[r])(n,t);o.handlers=[]};return{loadScripts:function(o,r,i){var a=function(n){return void 0!==i?i(n):void 0};if(0!==o.length)for(var s=0,c=!1,u=function(n,e){c||(e?(c=!0,a(e)):++s===o.length&&r())},l=0,p=o;l<p.length;l++){var d=p[l],f=e[d.src];if(f)f.done?u(d.src,f.error):f.handlers.push(u);else{var h=m("tiny-");e[d.src]={id:h,src:d.src,done:!1,error:null,handlers:[u]},I(n,w({id:h},d),t)}}else a(new Error("At least one script must be provided"))},deleteScripts:function(){for(var t,o=0,r=Object.values(e);o<r.length;o++){var i=r[o],a=n.getElementById(i.id);null!=a&&"SCRIPT"===a.tagName&&(null===(t=a.parentNode)||void 0===t||t.removeChild(a))}e={}},getDocument:function(){return n}}}(n),p.push(e)),e},{loadList:function(n,e,t,o,r){var i=function(){return d(n).loadScripts(e,o,r)};t>0?setTimeout(i,t):i()},reinitialize:function(){for(var n=p.pop();null!=n;n=p.pop())n.deleteScripts()}}),j=function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),L=function(){return L=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},L.apply(this,arguments)},B="change keyup compositionend setcontent CommentChange",D=function(n){function t(t){var o,r,i,a=n.call(this,t)||this;return a.rollbackTimer=void 0,a.valueCursor=void 0,a.rollbackChange=function(){var n=a.editor,e=a.props.value;n&&e&&e!==a.currentContent&&n.undoManager.ignore(function(){if(n.setContent(e),a.valueCursor&&(!a.inline||n.hasFocus()))try{n.selection.moveToBookmark(a.valueCursor)}catch(t){}}),a.rollbackTimer=void 0},a.handleBeforeInput=function(n){if(void 0!==a.props.value&&a.props.value===a.currentContent&&a.editor&&(!a.inline||a.editor.hasFocus()))try{a.valueCursor=a.editor.selection.getBookmark(3)}catch(e){}},a.handleBeforeInputSpecial=function(n){"Enter"!==n.key&&"Backspace"!==n.key&&"Delete"!==n.key||a.handleBeforeInput(n)},a.handleEditorChange=function(n){var e=a.editor;if(e&&e.initialized){var t=e.getContent();void 0!==a.props.value&&a.props.value!==t&&!1!==a.props.rollback&&(a.rollbackTimer||(a.rollbackTimer=window.setTimeout(a.rollbackChange,"number"==typeof a.props.rollback?a.props.rollback:200))),t!==a.currentContent&&(a.currentContent=t,f(a.props.onEditorChange)&&a.props.onEditorChange(t,e))}},a.handleEditorChangeSpecial=function(n){"Backspace"!==n.key&&"Delete"!==n.key||a.handleEditorChange(n)},a.initialise=function(n){var e,t,o;void 0===n&&(n=0);var r=a.elementRef.current;if(r)if(function(n){if(!("isConnected"in Node.prototype)){for(var e=n,t=n.parentNode;null!=t;)t=(e=t).parentNode;return e===n.ownerDocument}return n.isConnected}(r)){var i,s,c=S(a.view),u=L(L(L(L(L(L({},a.props.init),{selector:void 0,target:r}),k(a.view)?{disabled:a.props.disabled,readonly:a.props.readonly}:{readonly:a.props.disabled||a.props.readonly}),{inline:a.inline,plugins:(i=null===(e=a.props.init)||void 0===e?void 0:e.plugins,s=a.props.plugins,C(i).concat(C(s))),toolbar:null!==(t=a.props.toolbar)&&void 0!==t?t:null===(o=a.props.init)||void 0===o?void 0:o.toolbar}),a.props.licenseKey?{license_key:a.props.licenseKey}:{}),{setup:function(n){a.editor=n,a.bindHandlers({}),a.inline&&!b(r)&&n.once("PostRender",function(e){n.setContent(a.getInitialValue(),{no_events:!0})}),a.props.init&&f(a.props.init.setup)&&a.props.init.setup(n)},init_instance_callback:function(n){var e,t=a.getInitialValue();a.currentContent=null!==(e=a.currentContent)&&void 0!==e?e:n.getContent(),a.currentContent!==t&&(a.currentContent=t,n.setContent(t),n.undoManager.clear(),n.undoManager.add(),n.setDirty(!1)),a.props.init&&f(a.props.init.init_instance_callback)&&a.props.init.init_instance_callback(n)}});a.inline||(r.style.visibility=""),b(r)&&(r.value=a.getInitialValue()),c.init(u)}else if(0===n)setTimeout(function(){return a.initialise(1)},1);else{if(!(n<100))throw new Error("tinymce can only be initialised when in a document");setTimeout(function(){return a.initialise(n+1)},100)}},a.id=a.props.id||m("tiny-react"),a.elementRef=e.createRef(),a.inline=null!==(i=null!==(o=a.props.inline)&&void 0!==o?o:null===(r=a.props.init)||void 0===r?void 0:r.inline)&&void 0!==i&&i,a.boundHandlers={},a}return j(t,n),Object.defineProperty(t.prototype,"view",{get:function(){var n,e;return null!==(e=null===(n=this.elementRef.current)||void 0===n?void 0:n.ownerDocument.defaultView)&&void 0!==e?e:window},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(n){var e,t,o=this;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(n),this.editor.initialized)){if(this.currentContent=null!==(e=this.currentContent)&&void 0!==e?e:this.editor.getContent(),"string"==typeof this.props.initialValue&&this.props.initialValue!==n.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if("string"==typeof this.props.value&&this.props.value!==this.currentContent){var r=this.editor;r.undoManager.transact(function(){var n;if(!o.inline||r.hasFocus())try{n=r.selection.getBookmark(3)}catch(s){}var e=o.valueCursor;if(r.setContent(o.props.value),!o.inline||r.hasFocus())for(var t=0,i=[n,e];t<i.length;t++){var a=i[t];if(a)try{r.selection.moveToBookmark(a),o.valueCursor=a;break}catch(s){}}})}if(this.props.readonly!==n.readonly){var i=null!==(t=this.props.readonly)&&void 0!==t&&t;E(this.editor,i?"readonly":"design")}this.props.disabled!==n.disabled&&(k(this.view)?this.editor.options.set("disabled",this.props.disabled):E(this.editor,this.props.disabled?"readonly":"design"))}},t.prototype.componentDidMount=function(){var n,e,t,o,r,a=this;if(null!==i(this.view))this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&0===this.props.tinymceScriptSrc.length)null===(e=(n=this.props).onScriptsLoadError)||void 0===e||e.call(n,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(null===(t=this.elementRef.current)||void 0===t?void 0:t.ownerDocument){O.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),null!==(r=null===(o=this.props.scriptLoading)||void 0===o?void 0:o.delay)&&void 0!==r?r:0,function(){var n,e;null===(e=(n=a.props).onScriptsLoad)||void 0===e||e.call(n),a.initialise()},function(n){var e,t;null===(t=(e=a.props).onScriptsLoadError)||void 0===t||t.call(e,n)})}},t.prototype.componentWillUnmount=function(){var n=this,e=this.editor;e&&(e.off(B,this.handleEditorChange),e.off(this.beforeInputEvent(),this.handleBeforeInput),e.off("keypress",this.handleEditorChangeSpecial),e.off("keydown",this.handleBeforeInputSpecial),e.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(t){e.off(t,n.boundHandlers[t])}),this.boundHandlers={},e.remove(),this.editor=void 0)},t.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},t.prototype.beforeInputEvent=function(){return window.InputEvent&&"function"==typeof InputEvent.prototype.getTargetRanges?"beforeinput SelectionChange":"SelectionChange"},t.prototype.renderInline=function(){var n=this.props.tagName,t=void 0===n?"div":n;return e.createElement(t,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.renderIframe=function(){return e.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},t.prototype.getScriptSources=function(){var n,e,t=null===(n=this.props.scriptLoading)||void 0===n?void 0:n.async,o=null===(e=this.props.scriptLoading)||void 0===e?void 0:e.defer;if(void 0!==this.props.tinymceScriptSrc)return"string"==typeof this.props.tinymceScriptSrc?[{src:this.props.tinymceScriptSrc,async:t,defer:o}]:this.props.tinymceScriptSrc.map(function(n){return"string"==typeof n?{src:n,async:t,defer:o}:n});var r=this.props.cloudChannel,i=this.props.apiKey?this.props.apiKey:"no-api-key";return[{src:"https://cdn.tiny.cloud/1/".concat(i,"/tinymce/").concat(r,"/tinymce.min.js"),async:t,defer:o}]},t.prototype.getInitialValue=function(){return"string"==typeof this.props.initialValue?this.props.initialValue:"string"==typeof this.props.value?this.props.value:""},t.prototype.bindHandlers=function(n){var e=this;if(void 0!==this.editor){y(this.editor,n,this.props,this.boundHandlers,function(n){return e.props[n]});var t=function(n){return void 0!==n.onEditorChange||void 0!==n.value},o=t(n),r=t(this.props);!o&&r?(this.editor.on(B,this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):o&&!r&&(this.editor.off(B,this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},t.propTypes=r,t.defaultProps={cloudChannel:"7"},t}(e.Component);export{D as E};
