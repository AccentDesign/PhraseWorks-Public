import{j as e,r as s}from"./vendor-react.js";import{A as a,ae as l,af as t,ag as n,n as i,ah as c,ai as r,q as d}from"./index.js";import{z as o,L as x}from"./vendor-headless-ui.js";const h=({sliderOpen:s,setSliderOpen:a})=>e.jsx("div",{className:"title-panel",children:e.jsxs("div",{className:"title-bar",children:[e.jsx("h2",{className:"text-3xl",children:"Plugins"}),e.jsx("p",{className:"text-sm text-gray-500",children:"To add Plugins you need to be in local development mode"})]})}),u=({plugins:s,selectedIds:a,toggleCheckbox:l,activatePlugin:t,deactivatePlugin:n,allSelected:i,toggleAllCheckboxes:c})=>e.jsxs("table",{className:"plugins-table table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:e.jsx("input",{type:"checkbox",checked:i,onChange:c,className:"checkbox"})}),e.jsx("th",{scope:"col",children:"Plugin"}),e.jsx("th",{scope:"col",children:"Description"})]})}),e.jsx("tbody",{children:s.map((s,i)=>e.jsxs("tr",{className:(s.active?"bg-blue-50":"bg-white")+" ",children:[e.jsx("td",{scope:"row",className:"table-checkbox-cell",children:e.jsx("input",{id:"default-checkbox",type:"checkbox",value:i,checked:a.includes(i),onChange:()=>l(i),className:"checkbox"})}),e.jsxs("td",{className:"flex flex-col",children:[e.jsx("div",{className:"flex flex-row items-center",children:s.name}),e.jsx("div",{className:"flex flex-row items-center gap-4",children:s.active?e.jsx("button",{type:"button",className:"activate-btn",onClick:e=>{e.preventDefault(),n(i)},children:"Deactivate"}):e.jsx("button",{type:"button",className:"activate-btn",onClick:e=>{e.preventDefault(),t(i)},children:"Activate"})})]}),e.jsxs("td",{children:[e.jsx("p",{children:s.description}),e.jsxs("p",{children:["Version: ",s.version," By"," ",""!=s.authorUrl?e.jsx("a",{href:s.authorUrl,className:"link",children:s.author}):e.jsx(e.Fragment,{children:s.author})]})]})]},i))})]}),p=({sliderOpen:c,setSliderOpen:r,fetchData:d})=>{const{loginPassword:h}=s.useContext(a),[u,p]=s.useState([]);return s.useEffect(()=>{(async()=>{const e=await t();200==e.status&&p(e.data.getPluginsRepo.plugins)})()},[]),e.jsx(o.Root,{show:c,as:s.Fragment,children:e.jsxs(x,{as:"div",className:"slide-panel",onClose:()=>{},children:[e.jsx("div",{className:"fixed inset-0"}),e.jsx("div",{className:"slide-panel-content-wrapper",children:e.jsx("div",{className:"slide-panel-content",children:e.jsx("div",{className:"slide-panel-content-inner",children:e.jsx(o.Child,{as:s.Fragment,enter:"transform transition ease-in-out duration-500 sm:duration-700",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-500 sm:duration-700",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(x.Panel,{className:"slide-panel-dialog-panel",children:e.jsx("div",{className:"slide-panel-dialog-panel-inner px-4 sm:px-6",children:e.jsx("div",{className:"slide-panel-dialog-relative",children:e.jsx("div",{className:"flex-start",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"slide-panel-dialog-header-wrapper",children:[e.jsx(x.Title,{className:"slide-panel-dialog-title",children:"Add Plugins"}),e.jsx("div",{className:"slide-panel-close-wrapper",children:e.jsxs("button",{type:"button",className:"slide-panel-close-btn",onClick:()=>{r(!1)},children:[e.jsx("span",{className:"absolute -inset-2.5"}),e.jsx("span",{className:"sr-only",children:"Close panel"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-6 w-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})})]})})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4 my-8",children:u.map((s,a)=>e.jsxs("div",{className:"border rounded p-4 flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 mb-2",dangerouslySetInnerHTML:l(s.logo)}),e.jsxs("div",{className:"text-center text-sm mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:JSON.parse(s.data).title||"No Title"}),e.jsx("p",{children:JSON.parse(s.data).version||"No Version"})]}),e.jsx("div",{className:"text-center mb-2",children:e.jsx("p",{children:JSON.parse(s.data).description||"No Description"})}),e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),(async e=>{200==(await n(h,e)).status&&(d(),r(!1),i("Plugin Installed","success"))})(s.file)},className:"text-blue-600 hover:underline",children:"Install Plugin"})]},a))})]})})})})})})})})})]})})},m=()=>{const{loginPassword:l}=s.useContext(a),[t,n]=s.useState([]),[o,x]=s.useState(!1),[m,g]=s.useState([]),j=t.length>0&&m.length===t.length,v=async()=>{const e=await c(l);200===e.status&&n(JSON.parse(e.data.getPlugins))};return s.useEffect(()=>{v()},[]),e.jsxs("div",{className:"w-full",children:[e.jsx(h,{setSliderOpen:x,sliderOpen:o}),e.jsx("div",{className:"panel mt-8",children:e.jsx(u,{plugins:t,selectedIds:m,toggleCheckbox:e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},activatePlugin:async e=>{const s=[...t];s[e]={...s[e],active:!0},n(s);try{const e=await r(l,s);200===e.status&&e.data.updatePlugins.success?i("Successfully updated plugins","success"):i("Failed to update plugins","error")}catch(a){await d(a.stack||String(a))}},deactivatePlugin:async e=>{const s=[...t];s[e]={...s[e],active:!1},n(s);const a=await r(l,s);200==a.status&&a.data.updatePlugins.success?i("Successfully updated plugins","success"):i("Failed to update plugins","error")},allSelected:j,toggleAllCheckboxes:()=>{m.length===t.length?g([]):g(t.map((e,s)=>s))}})}),e.jsx(p,{sliderOpen:o,setSliderOpen:x,fetchData:v})]})};export{m as P};
