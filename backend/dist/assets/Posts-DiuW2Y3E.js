import{j as e,L as P,r as i,A as F,U as L,a as V,b as E,c as G,d as H,e as p}from"./index-BW38UQiC.js";import{V as U,H as Z,P as q,F as z}from"./PageContent-_N4iWq5i.js";import"./index-CoHULwWn.js";const J=()=>e.jsx("div",{className:"relative overflow-hidden bg-white shadow-md dark:bg-gray-800 sm:rounded-lg",children:e.jsxs("div",{className:"flex-row items-center justify-between p-4 space-y-3 sm:flex sm:space-y-0 sm:space-x-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl",children:"Posts"})}),e.jsxs(P,{to:"/admin/posts/new",className:"flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-2 -ml-1",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"})}),"Add New Post"]})]})}),K=({setFilter:s,totalPosts:o,filter:l,posts:n,user:d})=>e.jsxs("div",{className:"flex flex-row gap-4 mt-4",children:[e.jsxs("button",{type:"button",onClick:()=>s("all"),className:`text-sm ${l=="all"?"text-black font-bold":"text-blue-800"}`,children:["All ",e.jsxs("span",{className:"font-normal",children:["(",o,")"]})]}),e.jsxs("button",{type:"button",onClick:()=>s("mine"),className:`text-sm ${l=="mine"?"text-black font-bold":"text-blue-800"}`,children:["Mine"," ",e.jsxs("span",{className:"font-normal",children:["(",n.filter(c=>c.post_author==d.id).length,")"]})]}),e.jsxs("button",{type:"button",onClick:()=>s("draft"),className:`text-sm ${l=="draft"?"text-black font-bold":"text-blue-800"}`,children:["Drafts"," ",e.jsxs("span",{className:"font-normal",children:["(",n.filter(c=>c.post_status=="draft").length,")"]})]}),n.filter(c=>c.post_status=="trash").length>0&&e.jsxs("button",{type:"button",onClick:()=>s("trash"),className:`text-sm ${l=="trash"?"text-black font-bold":"text-red-800"}`,children:["Trash"," ",e.jsxs("span",{className:"font-normal",children:["(",n.filter(c=>c.post_status=="trash").length,")"]})]})]}),O=({bulkAction:s,setBulkAction:o,handleApply:l,filter:n})=>e.jsxs("div",{className:"flex flex-row items-center mt-4",children:[e.jsxs("select",{id:"actionsDropdown",className:"bg-gray-100 border-gray-300 border px-4 py-2 divide-y divide-gray-100 rounded shadow w-44 dark:bg-gray-700 dark:divide-gray-600",value:s,onChange:d=>o(d.target.value),children:[e.jsx("option",{value:"",children:"Bulk Actions"}),n!="trash"?e.jsx("option",{value:"trash",children:"Trash Items"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"delete",children:"Delete Permanently"}),e.jsx("option",{value:"restore",children:"Restore"})]})]}),e.jsxs("button",{type:"button",className:"ml-4 flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",onClick:l,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-2 -ml-1",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"})}),"Apply"]})]}),Q=({posts:s,selectedIds:o,toggleCheckbox:l,restorePost:n,binPost:d,publishPost:c,draftPost:g,allSelected:x,toggleAllCheckboxes:w})=>e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-200  ",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:e.jsx("input",{type:"checkbox",checked:x,onChange:w,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 focus:ring-2"})}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Title"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Author"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Categories"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Tags"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Date"})]})}),e.jsx("tbody",{children:s.map((a,u)=>e.jsxs("tr",{className:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700 border-gray-200",children:[e.jsx("th",{scope:"row",className:"px-6 py-4 w-[40px] font-medium text-gray-900 whitespace-nowrap dark:text-white",children:e.jsx("input",{id:"default-checkbox",type:"checkbox",value:a.id,checked:o.includes(a.id),onChange:()=>l(a.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 focus:ring-2"})}),e.jsxs("td",{className:"px-6 py-4 flex flex-col",children:[e.jsx("div",{className:"flex flex-row items-center",children:e.jsxs(P,{to:`/admin/posts/edit/${a.id}`,className:"text-blue-700 font-bold",children:[a.post_title," - ",e.jsx("span",{className:"text-gray-800",children:a.post_status})]})}),e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[a.post_status=="publish"&&e.jsx("p",{children:e.jsx(P,{to:`/${a.post_name}`,className:"text-blue-700 text-sm underline underline-offset-4 hover:text-blue-500",children:"View"})}),a.post_status=="trash"?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx("button",{className:"text-blue-700 text-sm underline underline-offset-4 hover:text-blue-500",onClick:()=>n(a.id),children:"Restore"})}),e.jsx("p",{children:e.jsx("button",{className:"text-red-700 text-sm underline underline-offset-4 hover:text-blue-500",children:"Permanently Delete"})})]}):e.jsxs(e.Fragment,{children:[a.post_status!="publish"&&e.jsx("p",{children:e.jsx("button",{className:"text-blue-700 text-sm underline underline-offset-4 hover:text-blue-500",onClick:()=>{c(a.id)},children:"Publish"})}),a.post_status!="draft"&&e.jsx("p",{children:e.jsx("button",{className:"text-blue-700 text-sm underline underline-offset-4 hover:text-blue-500",onClick:()=>{g(a.id)},children:"Draft"})}),e.jsx("p",{children:e.jsx("button",{className:"text-red-700 text-sm underline underline-offset-4 hover:text-blue-500",onClick:()=>{d(a.id)},children:"Bin"})})]})]})]}),e.jsx("td",{className:"px-6 py-4",children:a.author.user_login}),e.jsx("td",{className:"px-6 py-4",children:"-"}),e.jsx("td",{className:"px-6 py-4",children:"-"}),e.jsx("td",{className:"px-6 py-4",children:new Date(a.post_date).toLocaleDateString()})]},u))})]}),W=({totalPosts:s,page:o,perPage:l,setPage:n})=>{const d=async()=>{n(1)},c=async()=>{n(o-1)},g=async()=>{n(o+1)},x=async()=>{n(Math.ceil(s/l))};return e.jsxs("div",{className:"flex flex-rows justify-end items-center px-4 py-8",children:[e.jsxs("p",{className:"mr-4",children:[s," items"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${o==1?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:d,children:"«"}),e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${o==1?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:c,children:"‹"}),e.jsxs("p",{children:[o," of ",Math.ceil(s/l)]}),e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${o==Math.ceil(s/l)?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:g,children:"›"}),e.jsx("button",{className:`px-3 py-2 font-medium rounded shadow ${o==Math.ceil(s/l)?"bg-gray-50 text-gray-200":"text-gray-800 bg-gray-200 hover:bg-gray-300"}`,onClick:x,children:"»"})]})]})},X=()=>{const{loginPassword:s}=i.useContext(F),{user:o}=i.useContext(L),[l,n]=i.useState([]),[d,c]=i.useState([]),[g,x]=i.useState(0),[w,a]=i.useState(!1),[u,k]=i.useState("all"),[f,A]=i.useState(1),[N,Y]=i.useState(20),[v,S]=i.useState(""),[h,b]=i.useState([]),B=r=>{b(t=>t.includes(r)?t.filter(m=>m!==r):[...t,r])},_=()=>{h.length===l.length?b([]):b(l.map(r=>r.id))},R=l.length>0&&h.length===l.length,D=async()=>{v==="trash"&&h.length>0?(await Promise.all(h.map(async t=>{var y,j;const m=await p(s,"trash",t);return m.status===200&&((j=(y=m.data)==null?void 0:y.updatePostStatus)==null?void 0:j.success)}))).some(t=>t)&&(a(!0),b([])):v==="restore"&&h.length>0&&(await Promise.all(h.map(async t=>{var y,j;const m=await p(s,"draft",t);return m.status===200&&((j=(y=m.data)==null?void 0:y.updatePostStatus)==null?void 0:j.success)}))).some(t=>t)&&(a(!0),b([]))},T=async r=>{const t=await p(s,"draft",r);t.status==200&&t.data.updatePostStatus.success&&a(!0)},$=async r=>{const t=await p(s,"trash",r);t.status==200&&t.data.updatePostStatus.success&&a(!0)},I=async r=>{const t=await p(s,"publish",r);t.status==200&&t.data.updatePostStatus.success&&a(!0)},M=async r=>{const t=await p(s,"draft",r);t.status==200&&t.data.updatePostStatus.success&&a(!0)},C=async()=>{if(u=="all"){const t=await V(s,f,N,"post");t.status==200&&(n(t.data.getPosts.posts),x(t.data.getPosts.total))}else if(u=="mine"){const t=await E(s,f,N,"post",o.id);t.status==200&&(n(t.data.getPostsByAuthor.posts),x(t.data.getPostsByAuthor.total))}else{const t=await G(s,f,N,"post",u);t.status==200&&(n(t.data.getPostsByStatus.posts),x(t.data.getPostsByStatus.total))}const r=await H(s,1,2147483647,"post");r.status==200&&c(r.data.getPosts.posts)};return i.useEffect(()=>{C()},[f,u]),i.useEffect(()=>{w&&(a(!1),u!="all"?k("all"):C())},[w]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full",children:[e.jsx(J,{}),e.jsx(K,{posts:d,totalPosts:g,filter:u,setFilter:k,user:o}),e.jsx(O,{bulkAction:v,setBulkAction:S,handleApply:D,filter:u}),e.jsxs("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg w-full mt-8",children:[e.jsx(Q,{posts:l,selectedIds:h,toggleCheckbox:B,restorePost:T,binPost:$,publishPost:I,draftPost:M,allSelected:R,toggleAllCheckboxes:_}),e.jsx(W,{totalPosts:g,page:f,perPage:N,setPage:A})]})]})})},ae=()=>(document.title="Posts",e.jsxs(U,{children:[e.jsx(Z,{}),e.jsx(q,{children:e.jsx(X,{})}),e.jsx(z,{})]}));export{ae as default};
