import React, { useEffect, useState, useContext } from 'react';
import { APIGetS3UploadPluginOptions, APIUpdateS3UploadPluginOptions } from '../../API/s3PluginAPI';
import { APIConnectorContext } from '../../../../Contexts/APIConnectorContext';
import { notify } from '../../../../Utils/Notification';

const PluginPageContent = () => {
  const { loginPassword } = useContext(APIConnectorContext);
  const [bucketName, setBucketName] = useState('');
  const [endpoint, setEndpoint] = useState('');
  const [accessKeyId, setAccessKeyId] = useState('');
  const [secretAccessKey, setSecretAccessKey] = useState('');

  const submitUpdate = async () => {
    if (bucketName != '' && endpoint != '' && accessKeyId != '' && secretAccessKey != '') {
      const data = await APIUpdateS3UploadPluginOptions(
        loginPassword,
        bucketName,
        endpoint,
        accessKeyId,
        secretAccessKey,
      );
      if (data.status == 200) {
        await fetchData();
        notify('Config saved successfully', 'success');
      } else {
        notify('Error saving config', 'errror');
      }
    }
  };

  const fetchData = async () => {
    const data = await APIGetS3UploadPluginOptions(loginPassword);
    if (data.status == 200) {
      const tmpData = JSON.parse(data.data.getS3UploadPluginOptions);
      setBucketName(tmpData.bucketName);
      setEndpoint(tmpData.endpoint);
      setAccessKeyId(tmpData.accessKeyId);
      setSecretAccessKey(tmpData.secretAccessKey);
    }
  };

  useEffect(() => {
    fetchData();
  }, []);

  return (
    <div>
      <div className="flex flex-row items-center gap-1">
        <svg version="1.1" viewBox="0 0 225 225" className="w-20">
          <path
            d="M0 0 C1.2365332 0.65452148 1.2365332 0.65452148 2.49804688 1.32226562 C3.31853516 1.73154297 4.13902344 2.14082031 4.984375 2.5625 C9.77881459 4.97693845 14.39184369 7.59193523 19.06054688 10.25976562 C19.06054688 18.17976563 19.06054688 26.09976563 19.06054688 34.25976562 C21.084375 33.75445312 23.10820312 33.24914063 25.19335938 32.72851562 C27.16914785 32.24152551 29.14494908 31.75458568 31.12109375 31.26904297 C32.48727215 30.93202214 33.85284595 30.59254003 35.21777344 30.25048828 C37.18723696 29.75740362 39.15875227 29.27340379 41.13085938 28.79101562 C42.90614014 28.35112305 42.90614014 28.35112305 44.71728516 27.90234375 C53.26634436 26.25920633 54.41557745 27.45700483 63.06054688 32.25976562 C63.06054688 64.92976563 63.06054688 97.59976563 63.06054688 131.25976562 C52.67465521 137.02970544 52.67465521 137.02970544 45.06054688 135.25976562 C43.50376221 134.93081299 43.50376221 134.93081299 41.91552734 134.59521484 C38.43246017 133.83616767 34.96555532 133.02432492 31.49804688 132.19726562 C30.29857422 131.91560547 29.09910156 131.63394531 27.86328125 131.34375 C24.92793265 130.65376766 21.99408297 129.95741384 19.06054688 129.25976562 C19.06054688 137.17976562 19.06054688 145.09976563 19.06054688 153.25976562 C16.06992188 154.84789062 13.07929688 156.43601563 9.99804688 158.07226562 C9.06984131 158.56702393 8.14163574 159.06178223 7.18530273 159.5715332 C5.58929204 160.41515591 3.98364144 161.24068011 2.37109375 162.05224609 C-0.16590169 163.33092165 -0.16590169 163.33092165 -3.28710938 165.44335938 C-9.44066409 166.81885984 -13.98085393 163.4340274 -19.31445312 160.50976562 C-20.41917969 159.93226563 -21.52390625 159.35476562 -22.66210938 158.75976562 C-30.63868202 154.56053673 -30.63868202 154.56053673 -31.93945312 153.25976562 C-32.02671535 151.47905316 -32.04644354 149.69493422 -32.03710938 147.91210938 C-32.03388672 146.83251953 -32.03066406 145.75292969 -32.02734375 144.640625 C-32.01477539 142.93616211 -32.01477539 142.93616211 -32.00195312 141.19726562 C-31.99744141 140.05708984 -31.99292969 138.91691406 -31.98828125 137.7421875 C-31.9764506 134.91466211 -31.95996722 132.08723923 -31.93945312 129.25976562 C-32.81158447 129.47705322 -33.68371582 129.69434082 -34.58227539 129.91821289 C-37.84327494 130.72419796 -41.10666814 131.51856726 -44.37231445 132.30541992 C-45.78065585 132.64721274 -47.18791576 132.99349612 -48.59399414 133.34448242 C-50.62438192 133.85045995 -52.65821107 134.33974404 -54.69335938 134.82617188 C-56.52362671 135.27391968 -56.52362671 135.27391968 -58.39086914 135.73071289 C-65.91455829 136.85240772 -69.17745631 135.12376381 -75.93945312 131.25976562 C-75.93945312 98.58976562 -75.93945312 65.91976562 -75.93945312 32.25976562 C-65.79263872 26.62264651 -65.79263872 26.62264651 -61.66992188 27.25585938 C-60.74614746 27.39233887 -59.82237305 27.52881836 -58.87060547 27.66943359 C-53.61726021 28.72745365 -48.4331075 29.95537362 -43.25195312 31.32226562 C-39.51882812 32.29164062 -35.78570312 33.26101562 -31.93945312 34.25976562 C-31.93945312 26.33976562 -31.93945312 18.41976562 -31.93945312 10.25976562 C-28.92820313 8.67164063 -25.91695312 7.08351563 -22.81445312 5.44726562 C-21.87714355 4.95250732 -20.93983398 4.45774902 -19.97412109 3.94799805 C-18.38105629 3.10871247 -16.78219393 2.28037679 -15.17895508 1.46069336 C-12.74928789 0.21023776 -12.74928789 0.21023776 -9.91210938 -1.81835938 C-5.79935889 -3.09379842 -3.76511428 -1.85697483 0 0 Z "
            fill="#8C3123"
            transform="translate(118.939453125,30.740234375)"
          />
          <path
            d="M0 0 C1.38566162 0.20471924 1.38566162 0.20471924 2.79931641 0.41357422 C8.05227086 1.47151557 13.23718921 2.69903578 18.41796875 4.06640625 C19.51302734 4.34806641 20.60808594 4.62972656 21.73632812 4.91992188 C24.40301425 5.60697201 27.06703504 6.30435378 29.73046875 7.00390625 C29.73046875 10.96390625 29.73046875 14.92390625 29.73046875 19.00390625 C30.61347656 19.12507813 31.49648437 19.24625 32.40625 19.37109375 C39.8862486 20.41556187 47.30957556 21.59995348 54.73046875 23.00390625 C54.73046875 26.30390625 54.73046875 29.60390625 54.73046875 33.00390625 C51.87741746 33.51111537 49.02330061 34.00984259 46.16796875 34.50390625 C45.36810547 34.64699219 44.56824219 34.79007813 43.74414062 34.9375 C42.55981445 35.14052734 42.55981445 35.14052734 41.3515625 35.34765625 C40.63411865 35.47333984 39.9166748 35.59902344 39.17749023 35.72851562 C36.0469082 36.08083494 32.88081362 36.00390625 29.73046875 36.00390625 C29.73046875 48.21390625 29.73046875 60.42390625 29.73046875 73.00390625 C35.01046875 73.33390625 40.29046875 73.66390625 45.73046875 74.00390625 C48.74786257 74.58681187 51.76193508 75.2087633 54.73046875 76.00390625 C55.22546875 80.45890625 55.22546875 80.45890625 55.73046875 85.00390625 C56.42197021 85.11460449 57.11347168 85.22530273 57.82592773 85.33935547 C60.94150711 85.84336553 64.05468004 86.36094317 67.16796875 86.87890625 C68.25658203 87.05292969 69.34519531 87.22695312 70.46679688 87.40625 C71.50126953 87.58027344 72.53574219 87.75429687 73.6015625 87.93359375 C74.5598999 88.09069824 75.5182373 88.24780273 76.50561523 88.40966797 C77.23981689 88.6057666 77.97401855 88.80186523 78.73046875 89.00390625 C79.06046875 89.66390625 79.39046875 90.32390625 79.73046875 91.00390625 C55.30154496 98.41206743 55.30154496 98.41206743 44.73046875 95.00390625 C43.38354679 94.64716861 42.03439168 94.2987994 40.68359375 93.95703125 C37.01714508 93.02346048 33.37239111 92.02881883 29.73046875 91.00390625 C29.73046875 94.63390625 29.73046875 98.26390625 29.73046875 102.00390625 C25.59002436 103.03547932 21.44587578 104.0500414 17.29760742 105.04956055 C15.88926603 105.39135336 14.48200612 105.73763674 13.07592773 106.08862305 C11.04553996 106.59460058 9.01171081 107.08388467 6.9765625 107.5703125 C5.75638428 107.86881104 4.53620605 108.16730957 3.27905273 108.47485352 C-4.24463641 109.59654835 -7.50753443 107.86790443 -14.26953125 104.00390625 C-14.26953125 71.33390625 -14.26953125 38.66390625 -14.26953125 5.00390625 C-4.12271685 -0.63321286 -4.12271685 -0.63321286 0 0 Z "
            fill="#DF5243"
            transform="translate(57.26953125,57.99609375)"
          />
          <path
            d="M0 0 C0.33 0 0.66 0 1 0 C1 2.97 1 5.94 1 9 C9.25 9.99 17.5 10.98 26 12 C26 24.21 26 36.42 26 49 C17.75 49.99 9.5 50.98 1 52 C1 54.97 1 57.94 1 61 C0.67 61 0.34 61 0 61 C0 58.03 0 55.06 0 52 C-12.375 50.515 -12.375 50.515 -25 49 C-25 36.79 -25 24.58 -25 12 C-21.803125 11.505 -18.60625 11.01 -15.3125 10.5 C-14.31387939 10.34337891 -13.31525879 10.18675781 -12.28637695 10.02539062 C-11.08694458 9.84266602 -11.08694458 9.84266602 -9.86328125 9.65625 C-9.05157471 9.53056641 -8.23986816 9.40488281 -7.40356445 9.27539062 C-4.91466595 8.99022277 -2.50293311 8.95325261 0 9 C0 6.03 0 3.06 0 0 Z "
            fill="#DD5041"
            transform="translate(112,82)"
          />
          <path
            d="M0 0 C0.46158317 3.2381835 0.70509937 6.46321352 0.86572266 9.72949219 C0.96506681 11.4093115 1.10048516 13.08708422 1.25537109 14.76269531 C2.49146598 29.35567836 2.49146598 29.35567836 0 36 C-4.37545105 40.89306667 -10.58157001 43.18869193 -16.70556641 45.17919922 C-19.27437768 46.00610763 -19.27437768 46.00610763 -22.34375 48.08984375 C-28.49615441 49.62137177 -33.0247279 46.18340306 -38.375 43.25 C-39.47972656 42.6725 -40.58445312 42.095 -41.72265625 41.5 C-49.6992289 37.3007711 -49.6992289 37.3007711 -51 36 C-51.08851529 33.40640678 -51.11525945 30.83960309 -51.09765625 28.24609375 C-51.09553383 27.08292381 -51.09553383 27.08292381 -51.09336853 25.89625549 C-51.08775345 23.40996506 -51.07519846 20.9237634 -51.0625 18.4375 C-51.05748694 16.75586067 -51.0529237 15.07421994 -51.04882812 13.39257812 C-51.03777913 9.26168434 -51.02050445 5.13085724 -51 1 C-42.47405494 1.98685307 -42.47405494 1.98685307 -39.10546875 3.04296875 C-30.70244974 5.51612642 -24.58716131 6.54002872 -16 4 C-14.67683524 3.64964088 -13.35252598 3.30358684 -12.02734375 2.9609375 C-9.34271592 2.2632554 -6.66536052 1.54500452 -3.9921875 0.8046875 C-1 0 -1 0 0 0 Z "
            fill="#DE5142"
            transform="translate(138,148)"
          />
          <path
            d="M0 0 C0.495 20.295 0.495 20.295 1 41 C11.89 43.97 11.89 43.97 23 47 C22.505 47.99 22.505 47.99 22 49 C5.52818787 53.46623762 -8.6065416 52.00450892 -25 48 C-25 36.12 -25 24.24 -25 12 C-21.9475 10.39125 -18.895 8.7825 -15.75 7.125 C-14.31672363 6.36920654 -14.31672363 6.36920654 -12.85449219 5.59814453 C-12.09297852 5.19708496 -11.33146484 4.79602539 -10.546875 4.3828125 C-9.77182617 3.97434082 -8.99677734 3.56586914 -8.19824219 3.14501953 C-7.47282227 2.76716309 -6.74740234 2.38930664 -6 2 C-5.2874707 1.62085449 -4.57494141 1.24170898 -3.84082031 0.85107422 C-2 0 -2 0 0 0 Z "
            fill="#8B3022"
            transform="translate(112,29)"
          />
          <path
            d="M0 0 C8.68460042 2.89486681 8.68460042 2.89486681 11 5 C11.74162463 8.13498511 11.63063821 11.22140556 11.56762695 14.4284668 C11.56872215 15.87752914 11.56872215 15.87752914 11.56983948 17.35586548 C11.56635144 20.55421785 11.52743181 23.7511203 11.48828125 26.94921875 C11.47895748 29.16452743 11.47183931 31.3798464 11.46684265 33.59516907 C11.44773874 39.42994582 11.39860796 45.26410164 11.34332275 51.09863281 C11.29220385 57.05069579 11.2693443 63.00285897 11.24414062 68.95507812 C11.19049312 80.63699178 11.10513872 92.31844429 11 104 C9.54462432 104.83848804 8.08559627 105.67063934 6.625 106.5 C5.81289062 106.9640625 5.00078125 107.428125 4.1640625 107.90625 C2 109 2 109 0 109 C0 73.03 0 37.06 0 0 Z "
            fill="#E05141"
            transform="translate(171,58)"
          />
          <path
            d="M0 0 C0 35.97 0 71.94 0 109 C-8.68460042 106.10513319 -8.68460042 106.10513319 -11 104 C-11.74162463 100.86501489 -11.63063821 97.77859444 -11.56762695 94.5715332 C-11.56835709 93.60549164 -11.56908722 92.63945007 -11.56983948 91.64413452 C-11.56635144 88.44578215 -11.52743181 85.2488797 -11.48828125 82.05078125 C-11.47895748 79.83547257 -11.47183931 77.6201536 -11.46684265 75.40483093 C-11.44773874 69.57005418 -11.39860796 63.73589836 -11.34332275 57.90136719 C-11.29220385 51.94930421 -11.2693443 45.99714103 -11.24414062 40.04492188 C-11.19049312 28.36300822 -11.10513872 16.68155571 -11 5 C-9.54462432 4.16151196 -8.08559627 3.32936066 -6.625 2.5 C-5.81289063 2.0359375 -5.00078125 1.571875 -4.1640625 1.09375 C-2 0 -2 0 0 0 Z "
            fill="#8A2E1F"
            transform="translate(54,58)"
          />
          <path
            d="M0 0 C4.4859375 2.10375 4.4859375 2.10375 9.0625 4.25 C10.45480835 4.9001709 10.45480835 4.9001709 11.87524414 5.56347656 C13.47313225 6.3167496 15.06249742 7.08824934 16.64501953 7.87329102 C18.93296118 9.0179727 18.93296118 9.0179727 21.14794922 9.76538086 C23.05859375 10.54296875 23.05859375 10.54296875 26 13 C27.05072069 17.01385584 27.02400221 20.93171931 27 25.0625 C27.02449219 26.14466797 27.04898438 27.22683594 27.07421875 28.34179688 C27.18248762 35.28349733 26.77308933 42.1034565 26 49 C22.60265718 48.21472065 19.20742742 47.42065119 15.8125 46.625 C14.37293945 46.29242188 14.37293945 46.29242188 12.90429688 45.953125 C11.50727539 45.62441406 11.50727539 45.62441406 10.08203125 45.2890625 C8.80162964 44.99056396 8.80162964 44.99056396 7.49536133 44.68603516 C5 44 5 44 0 42 C0 28.14 0 14.28 0 0 Z "
            fill="#DE5142"
            transform="translate(112,28)"
          />
          <path
            d="M0 0 C0 13.86 0 27.72 0 42 C-9 42 -9 42 -25 40 C-25 27.79 -25 15.58 -25 3 C-20.2046875 2.2575 -20.2046875 2.2575 -15.3125 1.5 C-13.81456909 1.26506836 -13.81456909 1.26506836 -12.28637695 1.02539062 C-11.08694458 0.84266602 -11.08694458 0.84266602 -9.86328125 0.65625 C-9.05157471 0.53056641 -8.23986816 0.40488281 -7.40356445 0.27539062 C-5 0 -5 0 0 0 Z "
            fill="#8C3123"
            transform="translate(112,91)"
          />
          <path
            d="M0 0 C9.01145874 1.12643234 9.01145874 1.12643234 12.24609375 1.9375 C12.93767578 2.11023438 13.62925781 2.28296875 14.34179688 2.4609375 C15.03337891 2.63882813 15.72496094 2.81671875 16.4375 3 C17.15615234 3.17789063 17.87480469 3.35578125 18.61523438 3.5390625 C23.86850111 4.86850111 23.86850111 4.86850111 25 6 C25.08871273 9.02977804 25.1151935 12.03667022 25.09765625 15.06640625 C25.0962413 15.97502914 25.09482635 16.88365204 25.09336853 17.81980896 C25.08775193 20.73407221 25.07519665 23.64825981 25.0625 26.5625 C25.05748714 28.53320202 25.05292386 30.50390524 25.04882812 32.47460938 C25.03777711 37.31643559 25.02050138 42.15820495 25 47 C21.22153891 45.81057293 17.75079192 44.48329979 14.2578125 42.6171875 C13.50129395 42.21612793 12.74477539 41.81506836 11.96533203 41.40185547 C10.55936768 40.64606201 10.55936768 40.64606201 9.125 39.875 C6.11375 38.26625 3.1025 36.6575 0 35 C0 23.45 0 11.9 0 0 Z "
            fill="#8B3022"
            transform="translate(87,149)"
          />
          <path
            d="M0 0 C0.495 0.99 0.495 0.99 1 2 C-23.55687292 9.44696223 -23.55687292 9.44696223 -34 6 C-35.9332226 5.47078278 -37.86646543 4.94163307 -39.80053711 4.41552734 C-42.54698695 3.65401952 -45.27382496 2.83075748 -48 2 C-47 0 -47 0 -45.15600586 -0.65771484 C-29.94447103 -4.10499336 -15.06041979 -5.07540292 0 0 Z "
            fill="#EFABA4"
            transform="translate(136,147)"
          />
          <path
            d="M0 0 C-0.33 0.66 -0.66 1.32 -1 2 C-3.43357909 2.65985105 -5.77492494 3.18280999 -8.25 3.625 C-8.97437256 3.75471191 -9.69874512 3.88442383 -10.44506836 4.01806641 C-22.26025928 5.998295 -33.47986938 5.24888548 -45 2 C-45.66 1.34 -46.32 0.68 -47 0 C-45.79601562 -0.27714844 -44.59203125 -0.55429688 -43.3515625 -0.83984375 C-41.77601093 -1.20559679 -40.20049177 -1.57148945 -38.625 -1.9375 C-37.8309375 -2.11990234 -37.036875 -2.30230469 -36.21875 -2.49023438 C-35.45820312 -2.66748047 -34.69765625 -2.84472656 -33.9140625 -3.02734375 C-32.8614624 -3.27085571 -32.8614624 -3.27085571 -31.78759766 -3.51928711 C-20.43147316 -6.57312611 -11.1246884 -3.39315115 0 0 Z "
            fill="#5F1F18"
            transform="translate(135,76)"
          />
        </svg>
        <h2 className="text-2xl font-bold">S3 Uploads Plugin</h2>
      </div>
      <div className="mt-4">
        <label className="block">Bucket Name</label>
        <input
          type="bucketName"
          name="bucketName"
          id="bucketName"
          placeholder="Bucket Name"
          autoComplete="Bucket Name"
          value={bucketName}
          className="input"
          required=""
          onChange={(e) => setBucketName(e.target.value)}
        />
      </div>
      <div className="mt-4">
        <label className="block">Endpoint</label>
        <input
          type="endpoint"
          name="endpoint"
          id="endpoint"
          placeholder="Endpoint"
          autoComplete="Endpoint"
          value={endpoint}
          className="input"
          required=""
          onChange={(e) => setEndpoint(e.target.value)}
        />
      </div>
      <div className="mt-4">
        <label className="block">Access Key ID</label>
        <input
          type="accessKeyId"
          name="accessKeyId"
          id="accessKeyId"
          placeholder="Access Key ID"
          autoComplete="Access Key ID"
          value={accessKeyId}
          className="input"
          required=""
          onChange={(e) => setAccessKeyId(e.target.value)}
        />
      </div>
      <div className="mt-4">
        <label className="block">Secret Access Key</label>
        <input
          type="secretAccessKey"
          name="secretAccessKey"
          id="secretAccessKey"
          placeholder="Secret Access Key"
          autoComplete="Secret Access Key"
          value={secretAccessKey}
          className="input"
          required=""
          onChange={(e) => setSecretAccessKey(e.target.value)}
        />
      </div>

      <button
        type="button"
        className="text-white bg-blue-700 hover:bg-blue-800 btn mt-4"
        onClick={submitUpdate}
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          className="w-5 mr-2"
        >
          <path
            fillRule="evenodd"
            d="M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z"
            clipRule="evenodd"
          />
        </svg>
        Update
      </button>
    </div>
  );
};

export default PluginPageContent;
